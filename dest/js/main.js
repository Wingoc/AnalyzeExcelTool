$(function(){$("#importNormalList").click(function(){$("#importNormalList2").click()}),$("#importNormalList2").change(function(e){var t=$("#importNormalList2").val().split("\\")[2],n="./Excels/"+t;$("#pathArea").val(t);var r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType="arraybuffer",r.onload=function(e){for(var t=r.response,n=new Uint8Array(t),a=new Array,o=0;o!=n.length;++o)a[o]=String.fromCharCode(n[o]);var p=a.join(""),l=XLSX.read(p,{type:"binary"});$("#selectSheets").children().length>0&&$("#selectSheets").empty(),$.each(l.SheetNames,function(e,t){var n=$("<option>"+t+"</option>");$("#selectSheets").append(n)}),$("#checkNewCnTxt").unbind("click"),$("#checkNewEnTxt").unbind("click"),$("#convertNewTxt").unbind("click"),$("#exportNewList").unbind("click"),$("#exportGroupList").unbind("click");var i=$("#selectSheets").val(),h=$("#titleRow").val(),s=$("#dataRow").val(),c=l.Sheets[i],d=XLSX.utils.sheet_to_json(c,{header:"A"}),v="",u=0;$.each(d[h],function(e,t){v=e}),u=1!=v.length?26*(v[0].charCodeAt()-64)+(v[1].charCodeAt()-64):v.charCodeAt()-64,console.log("总列数："+u);var f=d.length;console.log("lengthRow: "+f),$(".standerCol").empty(),$(".appendTitles option:first-child").nextAll().remove(),$.each(d[h],function(e,t){var n=$("<option></option>"),r=$("<option></option>");n.html(t).val(e),r.html(t).val(e),$(".appendTitles").append(n),$(".standerCol").append(r)});var m="",x="",k="",g="";$("#checkEnFullName").children().remove(),$.each(d[h],function(e,t){if("英文全名"==t||"Full Name"==t){var n=d[h][e],r=$("<option>"+n+"</option>");return $("#checkEnFullName").append(r),m=e,!1}}),$("#checkEnShortName").children().remove(),$.each(d[h],function(e,t){if("英文缩写"==t||"Short Name"==t){var n=d[h][e],r=$("<option>"+n+"</option>");return $("#checkEnShortName").append(r),x=e,!1}}),$("#checkCnFullName").children().remove(),$.each(d[h],function(e,t){if("中文全名"==t||"Full Name Chinese"==t){var n=d[h][e],r=$("<option>"+n+"</option>");return $("#checkCnFullName").append(r),k=e,!1}}),$("#checkCnShortName").children().remove(),$.each(d[h],function(e,t){if("中文缩写"==t||"Short Name Chinese"==t){var n=d[h][e],r=$("<option>"+n+"</option>");return $("#checkCnShortName").append(r),g=e,!1}});var y=[];$("#checkNewEnTxt").click(function(){$("#sheetjs").children().remove();for(var e=$("#checkStander option:selected").val(),t=s;t<f;t++)if(void 0!=d[t][e]&&"DEL"!=d[t][e]){var n=d[t][m]+"*",r=d[t][x]+"\r\n";y.push(n),y.push(r);var a=$("<tr><td>"+n+r+"</td></tr>");$("#sheetjs").append(a)}saveAs(new Blob(y,{type:"text/plain;charset=utf-8"}),"英文名称列表.txt")}),$("#checkNewCnTxt").click(function(){$("#sheetjs").children().remove();for(var e=$("#checkStander option:selected").val(),t=[],n=s;n<f;n++)if(void 0!=d[n][e]&&"DEL"!=d[n][e]){var r=d[n][k]+"*",a=d[n][g]+"\r\n";t.push(r),t.push(a);var o=$("<tr><td>"+r+a+"</td></tr>");$("#sheetjs").append(o)}saveAs(new Blob(y,{type:"text/plain;charset=utf-8"}),"中文名称列表.txt")}),$("#convertNewTxt").click(function(){for(var e=$("#form3 .appendTitles option:selected"),t=$("#form3 .paramPreConfig option:selected"),n=e.length,r=$("#convertStander option:selected").val(),a=[],o=[],p=s;p<f;p++){var l=[],i=[];if(null!=d[p][r+""]&&"DEL"!=d[p][r]){for(var h=0;h<n;h++)if("空"!=e[h].value)if("不处理"==t[h].text){var c=e[h].value;if(i.push(e[h].text),void 0==d[p][c])l.push(" ");else{var v=d[p][c];l.push(v)}}else if("参数列数据加1"==t[h].text){var u=e[h].value;if(i.push(e[h].text),void 0==d[p][u])l.push(" ");else{var m=Number(d[p][u])+1;l.push(m)}}else if("参数列数据减1"==t[h].text){var x=e[h].value;if(i.push(e[h].text),void 0==d[p][x])l.push(" ");else{var k=d[p][x]-1;l.push(k)}}a.push(l),o.push(i)}}for(var g=[],y=0;y<a[0].length;y++){var S=[],w="",N="\r\n\r\n;"+o[0][y]+"\r\n";g.push(N);var b=$("<tr><td>"+N+"</td></tr>");$("#sheetjs").append(b);for(var A=0;A<a.length;A++)S.push(a[A][y]);for(var j=chunk(S,20),C=0;C<j.length;C++)if($('input[type="radio"][name="language"]:checked')){var T=$('input[type="radio"][name="language"]:checked').val();w="\t"+T+"\t"+j[C].join(",")+"\t\t;"+(20*C+j[C].length)+"\r\n",g.push(w);var L=$("<tr><td>"+w+"</td></tr>");$("#sheetjs").append(L)}}console.log(g),saveAs(new Blob(g,{type:"text/plain;charset=utf-8"}),"汇编"+T+".txt")}),$("#exportNewList").click(function(){$("#sheetjs").children().remove();for(var e=$("#exportArea .appendTitles option:selected"),t=e.length,n=$("#exportStander option:selected").val(),r=[],a=[],o=s;o<f;o++){var p=[],l=[];if(null!=d[o][n+""]&&"DEL"!=d[o][n]){for(var h=0;h<t;h++)if("空"!=e[h].value){var c=e[h].value;l.push(e[h].text),void 0==d[o][c]?p.push(" "):p.push(d[o][c])}r.push(p),a.push(l)}}$("#sheetjs").empty();for(var v=$("<tr></tr>"),u=0;u<a[0].length;u++){var m=$("<th>"+a[0][u]+"</th>");v.append(m)}$("#sheetjs").append(v);for(u=0;u<r.length;u++){for(var x=$("<tr></tr>"),k=0;k<r[0].length;k++){var g=$("<td>"+r[u][k]+"</td>");x.append(g)}$("#sheetjs").append(x)}var y=document.getElementById("sheetjs"),S=XLSX.utils.table_to_book(y),w={bookType:"xlsx",bookSST:!1,type:"binary"},N=XLSX.write(S,w);saveAs(new Blob([function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}(N)],{type:"application/octet-stream"}),i+".xlsx")}),$("#selectSheets").change(function(){$("#checkNewCnTxt").unbind("click"),$("#checkNewEnTxt").unbind("click"),$("#convertNewTxt").unbind("click"),$("#exportNewList").unbind("click"),$("#exportGroupList").unbind("click");var e=$("#selectSheets").val(),t=$("#titleRow").val(),n=$("#dataRow").val(),r=l.Sheets[e],a=XLSX.utils.sheet_to_json(r,{header:"A"}),o="",p=0;$.each(a[t],function(e,t){o=e}),p=1!=o.length?26*(o[0].charCodeAt()-64)+(o[1].charCodeAt()-64):o.charCodeAt()-64,console.log("总列数："+p);var i=a.length;console.log("lengthRow: "+i),$(".standerCol").empty(),$(".appendTitles option:first-child").nextAll().remove(),$.each(a[t],function(e,t){var n=$("<option></option>"),r=$("<option></option>");n.html(t).val(e),r.html(t).val(e),$(".appendTitles").append(n),$(".standerCol").append(r)});var h="",s="",c="",d="";$("#checkEnFullName").children().remove(),$.each(a[t],function(e,n){if("英文全名"==n||"Full Name"==n){var r=a[t][e],o=$("<option>"+r+"</option>");return $("#checkEnFullName").append(o),h=e,!1}}),$("#checkEnShortName").children().remove(),$.each(a[t],function(e,n){if("英文缩写"==n||"Short Name"==n){var r=a[t][e],o=$("<option>"+r+"</option>");return $("#checkEnShortName").append(o),s=e,!1}}),$("#checkCnFullName").children().remove(),$.each(a[t],function(e,n){if("中文全名"==n||"Full Name Chinese"==n){var r=a[t][e],o=$("<option>"+r+"</option>");return $("#checkCnFullName").append(o),c=e,!1}}),$("#checkCnShortName").children().remove(),$.each(a[t],function(e,n){if("中文缩写"==n||"Short Name Chinese"==n){var r=a[t][e],o=$("<option>"+r+"</option>");return $("#checkCnShortName").append(o),d=e,!1}}),$("#checkNewEnTxt").click(function(){$("#sheetjs").children().remove();for(var e=$("#checkStander option:selected").val(),t=[],r=n;r<i;r++)if(void 0!=a[r][e]&&"DEL"!=a[r][e]){var o=a[r][h]+"*",p=a[r][s]+"\r\n";t.push(o),t.push(p);var l=$("<tr><td>"+o+p+"</td></tr>");$("#sheetjs").append(l)}saveAs(new Blob(t,{type:"text/plain;charset=utf-8"}),"英文名称列表.txt")}),$("#checkNewCnTxt").click(function(){$("#sheetjs").children().remove();for(var e=$("#checkStander option:selected").val(),t=[],r=n;r<i;r++)if(void 0!=a[r][e]&&"DEL"!=a[r][e]){var o=a[r][c]+"*",p=a[r][d]+"\r\n";t.push(o),t.push(p);var l=$("<tr><td>"+o+p+"</td></tr>");$("#sheetjs").append(l)}saveAs(new Blob(t,{type:"text/plain;charset=utf-8"}),"中文名称列表.txt")}),$("#convertNewTxt").click(function(){for(var e=$("#form3 .appendTitles option:selected"),t=$("#form3 .paramPreConfig option:selected"),r=e.length,o=$("#convertStander option:selected").val(),p=[],l=[],h=n;h<i;h++){var s=[],c=[];if(null!=a[h][o+""]&&"DEL"!=a[h][o]){for(var d=0;d<r;d++)if("空"!=e[d].value)if("不处理"==t[d].text){var v=e[d].value;if(c.push(e[d].text),void 0==a[h][v])s.push(" ");else{var u=a[h][v];s.push(u)}}else if("参数列数据加1"==t[d].text){var f=e[d].value;if(c.push(e[d].text),void 0==a[h][f])s.push(" ");else{var m=Number(a[h][f])+1;s.push(m)}}else if("参数列数据减1"==t[d].text){var x=e[d].value;if(c.push(e[d].text),void 0==a[h][x])s.push(" ");else{var k=a[h][x]-1;s.push(k)}}p.push(s),l.push(c)}}for(var g=[],y=0;y<g[2][0].length;y++){var S=[],w="",N="\r\n\r\n;"+l[0][y]+"\r\n";g.push(N);var b=$("<tr><td>"+N+"</td></tr>");$("#sheetjs").append(b);for(var A=0;A<p.length;A++)S.push(p[A][y]);for(var j=chunk(S,20),C=0;C<j.length;C++)if($('input[type="radio"][name="language"]:checked')){var T=$('input[type="radio"][name="language"]:checked').val();w="\t"+T+"\t"+j[C].join(",")+"\t\t;"+(20*C+j[C].length)+"\r\n",g.push(w);var L=$("<tr><td>"+w+"</td></tr>");$("#sheetjs").append(L)}}console.log(g),saveAs(new Blob(g,{type:"text/plain;charset=utf-8"}),"汇编"+T+".txt")}),$("#exportNewList").click(function(){$("#sheetjs").children().remove();for(var t=$("#exportArea .appendTitles option:selected"),r=t.length,o=$("#exportStander option:selected").val(),p=[],l=[],h=n;h<i;h++){var s=[],c=[];if(null!=a[h][o+""]&&"DEL"!=a[h][o]){for(var d=0;d<r;d++)if("空"!=t[d].value){var v=t[d].value;c.push(t[d].text),void 0==a[h][v]?s.push(" "):s.push(a[h][v])}p.push(s),l.push(c)}}$("#sheetjs").empty();for(var u=$("<tr></tr>"),f=0;f<l.length;f++){var m=$("<th>"+l[0][f]+"</th>");u.append(m)}$("#sheetjs").append(u);for(f=0;f<p.length;f++){for(var x=$("<tr></tr>"),k=0;k<p[0].length;k++){var g=$("<td>"+p[f][k]+"</td>");x.append(g)}$("#sheetjs").append(x)}var y=document.getElementById("sheetjs"),S=XLSX.utils.table_to_book(y),w={bookType:"xlsx",bookSST:!1,type:"binary"},N=XLSX.write(S,w);saveAs(new Blob([function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}(N)],{type:"application/octet-stream"}),e+".xlsx")}),$("#exportGroupList").click(function(){$("#sheetjs").children().remove();for(var e=$("#exportArea .appendTitles option:selected"),t=(e.length,$("#exportStander option:selected").val()),r=[],o=[],p=n;p<i;p++){var l=[],h=[];if(null!=a[p][t+""]&&"DEL"!=a[p][t]){for(var s=0;s<2;s++)if("空"!=e[s].value){var c=e[s].value;h.push(e[s].text),void 0==a[p][c]?l.push(" "):l.push(a[p][c])}r.push(l),o.push(h)}}$("#sheetjs").empty();var d=$("<tr></tr>");d.append("<th>组序号</th>"),d.append("<th>组的数值范围</th>"),d.append("<th>"+o[0][0]+"</th>"),d.append("<th>"+o[0][1]+"</th>"),$("#sheetjs").append(d);for(var v=0,u=1,f=0;v<r.length;v++){var m=$("<tr></tr>");if(v+1<r.length&&r[v][0]==r[v+1][0])f++;else{var x=$("<td>"+u+"</td>");u++;var k=$("<td>"+(v+1-f)+"-"+(v+1)+"</td>");f=0;var g=$("<td>"+r[v][0]+"</td>"),y=$("<td>"+r[v][1]+"</td>");m.append(x),m.append(k),m.append(g),m.append(y),$("#sheetjs").append(m)}}var S=document.getElementById("sheetjs"),w=XLSX.utils.table_to_book(S),N={bookType:"xlsx",bookSST:!1,type:"binary"},b=XLSX.write(w,N);saveAs(new Blob([function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}(b)],{type:"application/octet-stream"}),"分组统计.xlsx")})}),$("#titleRow").change(function(){$("#checkNewCnTxt").unbind("click"),$("#checkNewEnTxt").unbind("click"),$("#convertNewTxt").unbind("click"),$("#exportNewList").unbind("click"),$("#exportGroupList").unbind("click");var e=$("#selectSheets").val(),t=$("#titleRow").val(),n=$("#dataRow").val(),r=l.Sheets[e],a=XLSX.utils.sheet_to_json(r,{header:"A"}),o="",p=0;$.each(a[t],function(e,t){o=e}),p=1!=o.length?26*(o[0].charCodeAt()-64)+(o[1].charCodeAt()-64):o.charCodeAt()-64,console.log("总列数："+p);var i=a.length;console.log("lengthRow: "+i),$(".standerCol").empty(),$(".appendTitles option:first-child").nextAll().remove(),$.each(a[t],function(e,t){var n=$("<option></option>"),r=$("<option></option>");n.html(t).val(e),r.html(t).val(e),$(".appendTitles").append(n),$(".standerCol").append(r)});var h="",s="",c="",d="";$("#checkEnFullName").children().remove(),$.each(a[t],function(e,n){if("英文全名"==n||"Full Name"==n){var r=a[t][e],o=$("<option>"+r+"</option>");return $("#checkEnFullName").append(o),h=e,!1}}),$("#checkEnShortName").children().remove(),$.each(a[t],function(e,n){if("英文缩写"==n||"Short Name"==n){var r=a[t][e],o=$("<option>"+r+"</option>");return $("#checkEnShortName").append(o),s=e,!1}}),$("#checkCnFullName").children().remove(),$.each(a[t],function(e,n){if("中文全名"==n||"Full Name Chinese"==n){var r=a[t][e],o=$("<option>"+r+"</option>");return $("#checkCnFullName").append(o),c=e,!1}}),$("#checkCnShortName").children().remove(),$.each(a[t],function(e,n){if("中文缩写"==n||"Short Name Chinese"==n){var r=a[t][e],o=$("<option>"+r+"</option>");return $("#checkCnShortName").append(o),d=e,!1}}),$("#checkNewEnTxt").click(function(){$("#sheetjs").children().remove();var e=$("#checkStander option:selected").val();console.log("valueCol: "+e);for(var t=[],r=n;r<i;r++)if(void 0!=a[r][e]&&"DEL"!=a[r][e]){var o=a[r][h]+"*",p=a[r][s]+"\r\n";t.push(o),t.push(p);var l=$("<tr><td>"+o+p+"</td></tr>");$("#sheetjs").append(l)}saveAs(new Blob(t,{type:"text/plain;charset=utf-8"}),"英文名称列表.txt")}),$("#checkNewCnTxt").click(function(){$("#sheetjs").children().remove();for(var e=$("#checkStander option:selected").val(),t=[],r=n;r<i;r++)if(void 0!=a[r][e]&&"DEL"!=a[r][e]){var o=a[r][c]+"*",p=a[r][d]+"\r\n";t.push(o),t.push(p);var l=$("<tr><td>"+o+p+"</td></tr>");$("#sheetjs").append(l)}saveAs(new Blob(t,{type:"text/plain;charset=utf-8"}),"中文名称列表.txt")}),$("#convertNewTxt").click(function(){for(var e=$("#form3 .appendTitles option:selected"),t=$("#form3 .paramPreConfig option:selected"),r=e.length,o=$("#convertStander option:selected").val(),p=[],l=[],h=n;h<i;h++){var s=[],c=[];if(null!=a[h][o+""]&&"DEL"!=a[h][o]){for(var d=0;d<r;d++)if("空"!=e[d].value)if("不处理"==t[d].text){var v=e[d].value;if(c.push(e[d].text),void 0==a[h][v])s.push(" ");else{var u=a[h][v];s.push(u)}}else if("参数列数据加1"==t[d].text){var f=e[d].value;if(c.push(e[d].text),void 0==a[h][f])s.push(" ");else{var m=Number(a[h][f])+1;s.push(m)}}else if("参数列数据减1"==t[d].text){var x=e[d].value;if(c.push(e[d].text),void 0==a[h][x])s.push(" ");else{var k=a[h][x]-1;s.push(k)}}p.push(s),l.push(c)}}for(var g=[],y=0;y<s.length;y++){var S=[],w="",N="\r\n\r\n;"+l[0][y]+"\r\n";g.push(N);var b=$("<tr><td>"+N+"</td></tr>");$("#sheetjs").append(b);for(var A=0;A<p.length;A++)S.push(p[A][y]);for(var j=chunk(S,20),C=0;C<j.length;C++)if($('input[type="radio"][name="language"]:checked')){var T=$('input[type="radio"][name="language"]:checked').val();w="\t"+T+"\t"+j[C].join(",")+"\t\t;"+(20*C+j[C].length)+"\r\n",g.push(w);var L=$("<tr><td>"+w+"</td></tr>");$("#sheetjs").append(L)}}console.log(g),saveAs(new Blob(g,{type:"text/plain;charset=utf-8"}),"汇编"+T+".txt")}),$("#exportNewList").click(function(){$("#sheetjs").children().remove();for(var t=$("#exportArea .appendTitles option:selected"),r=t.length,o=$("#exportStander option:selected").val(),p=[],l=[],h=n;h<i;h++){var s=[];if(null!=a[h][o+""]&&"DEL"!=a[h][o]){for(var c=0;c<r;c++)if("空"!=t[c].value){var d=t[c].value;titleArray1.push(t[c].text),void 0==a[h][d]?s.push(" "):s.push(a[h][d])}p.push(s),l.push(titleArray1)}}$("#sheetjs").empty();for(var v=$("<tr></tr>"),u=0;u<l[0].length;u++){var f=$("<th>"+l[0][u]+"</th>");v.append(f)}$("#sheetjs").append(v);for(u=0;u<p.length;u++){for(var m=$("<tr></tr>"),x=0;x<p[0].length;x++){var k=$("<td>"+p[u][x]+"</td>");m.append(k)}$("#sheetjs").append(m)}var g=document.getElementById("sheetjs"),y=XLSX.utils.table_to_book(g),S={bookType:"xlsx",bookSST:!1,type:"binary"},w=XLSX.write(y,S);saveAs(new Blob([function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}(w)],{type:"application/octet-stream"}),e+".xlsx")}),$("#exportGroupList").click(function(){$("#sheetjs").children().remove();for(var e=$("#exportArea .appendTitles option:selected"),t=(e.length,$("#exportStander option:selected").val()),r=[],o=[],p=n;p<i;p++){var l=[],h=[];if(null!=a[p][t+""]&&"DEL"!=a[p][t]){for(var s=0;s<2;s++)if("空"!=e[s].value){var c=e[s].value;h.push(e[s].text),void 0==a[p][c]?l.push(" "):l.push(a[p][c])}r.push(l),o.push(h)}}$("#sheetjs").empty();var d=$("<tr></tr>");d.append("<th>组序号</th>"),d.append("<th>组的数值范围</th>"),d.append("<th>"+o[0][0]+"</th>"),d.append("<th>"+o[0][1]+"</th>"),$("#sheetjs").append(d);for(var v=0,u=1,f=0;v<r.length;v++){var m=$("<tr></tr>");if(v+1<r.length&&r[v][0]==r[v+1][0])f++;else{var x=$("<td>"+u+"</td>");u++;var k=$("<td>"+(v+1-f)+"-"+(v+1)+"</td>");f=0;var g=$("<td>"+r[v][0]+"</td>"),y=$("<td>"+r[v][1]+"</td>");m.append(x),m.append(k),m.append(g),m.append(y),$("#sheetjs").append(m)}}var S=document.getElementById("sheetjs"),w=XLSX.utils.table_to_book(S),N={bookType:"xlsx",bookSST:!1,type:"binary"},b=XLSX.write(w,N);saveAs(new Blob([function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}(b)],{type:"application/octet-stream"}),"分组统计.xlsx")})}),$("#dataRow").change(function(){$("#checkNewCnTxt").unbind("click"),$("#checkNewEnTxt").unbind("click"),$("#convertNewTxt").unbind("click"),$("#exportNewList").unbind("click"),$("#exportGroupList").unbind("click");var e=$("#selectSheets").val(),t=$("#titleRow").val(),n=$("#dataRow").val(),r=l.Sheets[e],a=XLSX.utils.sheet_to_json(r,{header:"A"}),o="",p=0;$.each(a[t],function(e,t){o=e}),p=1!=o.length?26*(o[0].charCodeAt()-64)+(o[1].charCodeAt()-64):o.charCodeAt()-64,console.log("总列数："+p);var i=a.length;console.log("lengthRow: "+i),$(".standerCol").empty(),$(".appendTitles option:first-child").nextAll().remove(),$.each(a[t],function(e,t){var n=$("<option></option>"),r=$("<option></option>");n.html(t).val(e),r.html(t).val(e),$(".appendTitles").append(n),$(".standerCol").append(r)});var h="",s="",c="",d="";$("#checkEnFullName").children().remove(),$.each(a[t],function(e,n){if("英文全名"==n||"Full Name"==n){var r=a[t][e],o=$("<option>"+r+"</option>");return $("#checkEnFullName").append(o),h=e,!1}}),$("#checkEnShortName").children().remove(),$.each(a[t],function(e,n){if("英文缩写"==n||"Short Name"==n){var r=a[t][e],o=$("<option>"+r+"</option>");return $("#checkEnShortName").append(o),s=e,!1}}),$("#checkCnFullName").children().remove(),$.each(a[t],function(e,n){if("中文全名"==n||"Full Name Chinese"==n){var r=a[t][e],o=$("<option>"+r+"</option>");return $("#checkCnFullName").append(o),c=e,!1}}),$("#checkCnShortName").children().remove(),$.each(a[t],function(e,n){if("中文缩写"==n||"Short Name Chinese"==n){var r=a[t][e],o=$("<option>"+r+"</option>");return $("#checkCnShortName").append(o),d=e,!1}}),$("#checkNewEnTxt").click(function(){$("#sheetjs").children().remove();for(var e=$("#checkStander option:selected").val(),t=[],r=n;r<i;r++)if(void 0!=a[r][e]&&"DEL"!=a[r][e]){var o=a[r][h]+"*",p=a[r][s]+"\r\n";t.push(o),t.push(p);var l=$("<tr><td>"+o+p+"</td></tr>");$("#sheetjs").append(l)}saveAs(new Blob(t,{type:"text/plain;charset=utf-8"}),"英文名称列表.txt")}),$("#checkNewCnTxt").click(function(){$("#sheetjs").children().remove();for(var e=$("#checkStander option:selected").val(),t=[],r=n;r<i;r++)if(void 0!=a[r][e]&&"DEL"!=a[r][e]){var o=a[r][c]+"*",p=a[r][d]+"\r\n";t.push(o),t.push(p);var l=$("<tr><td>"+o+p+"</td></tr>");$("#sheetjs").append(l)}saveAs(new Blob(t,{type:"text/plain;charset=utf-8"}),"中文名称列表.txt")}),$("#convertNewTxt").click(function(){var e=$("#form3 .appendTitles option:selected"),t=$("#form3 .paramPreConfig option:selected"),r=e.length;console.log("lenCol: "+r);for(var o=$("#convertStander option:selected").val(),p=[],l=[],h=n;h<i;h++){var s=[],c=[];if(null!=a[h][o+""]&&"DEL"!=a[h][o]){for(var d=0;d<r;d++)if("空"!=e[d].value)if("不处理"==t[d].text){var v=e[d].value;if(c.push(e[d].text),void 0==a[h][v])s.push(" ");else{var u=a[h][v];s.push(u)}}else if("参数列数据加1"==t[d].text){var f=e[d].value;if(c.push(e[d].text),void 0==a[h][f])s.push(" ");else{var m=Number(a[h][f])+1;s.push(m)}}else if("参数列数据减1"==t[d].text){var x=e[d].value;if(c.push(e[d].text),void 0==a[h][x])s.push(" ");else{var k=a[h][x]-1;s.push(k)}}p.push(s),l.push(c)}}for(var g=[],y=0;y<p[0].length;y++){var S=[],w="",N="\r\n\r\n;"+l[0][y]+"\r\n";g.push(N);var b=$("<tr><td>"+N+"</td></tr>");$("#sheetjs").append(b);for(var A=0;A<p.length;A++)S.push(p[A][y]);for(var j=chunk(S,20),C=0;C<j.length;C++)if($('input[type="radio"][name="language"]:checked')&&"c"!=$('input[type="radio"][name="language"]:checked').val()){w="\t"+$('input[type="radio"][name="language"]:checked').val()+"\t"+j[C].join(",")+"\t\t;"+(20*C+j[C].length)+"\r\n",g.push(w);var T=$("<tr><td>"+w+"</td></tr>");$("#sheetjs").append(T)}}saveAs(new Blob(g,{type:"text/plain;charset=utf-8"}),"生成数据表格.asm")}),$("#exportNewList").click(function(){$("#sheetjs").children().remove();for(var t=$("#exportArea .appendTitles option:selected"),r=t.length,o=$("#exportStander option:selected").val(),p=[],l=[],h=n;h<i;h++){var s=[],c=[];if(null!=a[h][o+""]&&"DEL"!=a[h][o]){for(var d=0;d<r;d++)if("空"!=t[d].value){var v=t[d].value;c.push(t[d].text),void 0==a[h][v]?s.push(" "):s.push(a[h][v])}p.push(s),l.push(c)}}$("#sheetjs").empty();for(var u=$("<tr></tr>"),f=0;f<l[0].length;f++){var m=$("<th>"+l[0][f]+"</th>");u.append(m)}$("#sheetjs").append(u);for(f=0;f<p.length;f++){for(var x=$("<tr></tr>"),k=0;k<p[0].length;k++){var g=$("<td>"+p[f][k]+"</td>");x.append(g)}$("#sheetjs").append(x)}var y=document.getElementById("sheetjs"),S=XLSX.utils.table_to_book(y),w={bookType:"xlsx",bookSST:!1,type:"binary"},N=XLSX.write(S,w);saveAs(new Blob([function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}(N)],{type:"application/octet-stream"}),e+".xlsx")}),$("#exportGroupList").click(function(){$("#sheetjs").children().remove();for(var e=$("#exportArea .appendTitles option:selected"),t=(e.length,$("#exportStander option:selected").val()),r=[],o=[],p=n;p<i;p++){var l=[],h=[];if(null!=a[p][t+""]&&"DEL"!=a[p][t]){for(var s=0;s<2;s++)if("空"!=e[s].value){var c=e[s].value;h.push(e[s].text),void 0==a[p][c]?l.push(" "):l.push(a[p][c])}r.push(l),o.push(h)}}$("#sheetjs").empty();var d=$("<tr></tr>");d.append("<th>组序号</th>"),d.append("<th>组的数值范围</th>"),d.append("<th>"+o[0][0]+"</th>"),d.append("<th>"+o[0][1]+"</th>"),$("#sheetjs").append(d);for(var v=0,u=1,f=0;v<r.length;v++){var m=$("<tr></tr>");if(v+1<r.length&&r[v][0]==r[v+1][0])f++;else{var x=$("<td>"+u+"</td>");u++;var k=$("<td>"+(v+1-f)+"-"+(v+1)+"</td>");f=0;var g=$("<td>"+r[v][0]+"</td>"),y=$("<td>"+r[v][1]+"</td>");m.append(x),m.append(k),m.append(g),m.append(y),$("#sheetjs").append(m)}}var S=document.getElementById("sheetjs"),w=XLSX.utils.table_to_book(S),N={bookType:"xlsx",bookSST:!1,type:"binary"},b=XLSX.write(w,N);saveAs(new Blob([function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}(b)],{type:"application/octet-stream"}),"分组统计.xlsx")})})},r.send()})}),$(function(){$("#convertExpand").click(function(){$("#dialog2").css("z-index","1").toggle(100)})});var chunk=function(e,t){for(var n=[],r=0;r<Math.ceil(e.length/t);r++){var a=r*t,o=a+t;n.push(e.slice(a,o))}return n};